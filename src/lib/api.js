const API_BASE=(import.meta.env.VITE_API_BASE||'').replace(/\/$/,'');export async function api(p,{method='GET',token,body}={}){const h={'Content-Type':'application/json'};if(token)h.Authorization=`Bearer ${token}`;const r=await fetch(`${API_BASE}${p}`,{method,headers:h,body:body?JSON.stringify(body):undefined});const d=await r.json().catch(()=>({}));if(!r.ok)throw new Error(d.error||`Request failed (${r.status})`);return d}
